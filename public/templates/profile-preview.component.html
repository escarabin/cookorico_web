<div class="col-md-3 profile-picture-container">
    <div class="profile-picture"
         [ngStyle]="{'background-image': 'url(https://s3-eu-west-1.amazonaws.com/oechr-profile-picture/' + user.id + '.jpg)'}">
        <div class="edit-profile-picture"
             (click)="profilePictureModal.show()">
            <span class="fa fa-camera"></span> &nbsp;Modifier
        </div>
    </div>

</div>
<div class="col-md-6 user-basic-infos">
    <span class="user-identity">
        {{ user.civility.title }} {{ user.firstName }} {{ user.lastName }}<br />
    </span>

    <b class="editable"
       *ngIf="!editingBirthDate"
       (click)="editingBirthDate = true">
        {{ user.birthDate }}
    </b>
    <input type="date"
           *ngIf="editingBirthDate"
           [(ngModel)]="user.birthDate"
           (change)="editingBirthDate = false"
           class="form-control"/>

    -

    <b class="editable"
       *ngIf="!editingAdress"
       (click)="editingAdress = true">
        {{ user.place.adress }}
    </b>
    <input type="text"
           *ngIf="editingAdress"
           [(ngModel)]="user.place.adress"
           (change)="editingAdress = false"
           class="form-control"/>

    <br />
    <span *ngIf="user.phone">
        <span *ngIf="!editingPhone">Tél : </span>
        <b class="editable"
           *ngIf="!editingPhone"
           (click)="editingPhone = true">
            {{ user.phone }}
        </b>
        <input type="text"
               *ngIf="editingPhone"
               [(ngModel)]="user.phone"
               (change)="editingPhone = false"
               class="form-control"/>
    </span>
    <br />

    <span *ngIf="!editingEmail">E-mail : </span>
    <b class="editable"
       *ngIf="!editingEmail"
       (click)="editingEmail = true">
        {{ user.email }}
    </b>
    <input type="text"
           *ngIf="editingEmail"
           [(ngModel)]="user.email"
           (change)="editingEmail = false"
           class="form-control"/>
    <br />

    <span *ngIf="user.status">
        {{ user.status.title }}<br />
    </span>
    <span *ngIf="user.looking_for_job_naming">
        Profil recherché : <b>{{ user.looking_for_job_naming.title }}</b><br />
    </span>
</div>
<div class="col-md-3 resume-container">
    <span class="icon fa fa-file-pdf-o"></span>
    <br /><br />
    Voir mon CV
</div>

<div class="col-md-12">
    <h3>Présentation</h3>
    <div class="description"
         [class.editable]="editableProfile"
         (click)="editingDescription = true"
         *ngIf="!editingDescription"
         [innerHTML]="user.description">

    </div>
    <textarea class="form-control"
              rows="10"
              *ngIf="editingDescription"
              (change)="editingDescription = false"
              [(ngModel)]="user.description">

    </textarea>
</div>

<div class="col-md-12">
    <a [routerLink]="['/Profile/Experiences']">
        <h3>Expériences &nbsp;
            <span class="badge">{{ experiences.length }}</span>
            &nbsp; <span *ngIf="editableProfile" class="fa fa-pencil"></span>
        </h3>
    </a>
    <ul>
        <li *ngFor="let experience of experiences">
            <a [routerLink]="['EditExperience', { experienceId: experience.id }]">
                {{ experience.job_naming.title }}<br />
                {{ experience.business.title }}
            </a>
        </li>
    </ul>
</div>

<div class="col-md-12">
    <a [routerLink]="['/Profile/Education']">
        <h3>Formations &nbsp;
            <span class="badge">{{ education.length }}</span>
            &nbsp; <span *ngIf="editableProfile" class="fa fa-pencil"></span>
        </h3>
    </a>
    <ul>
        <li *ngFor="let study of education">
            <a [routerLink]="['EditStudy', { studyId: study.id }]">
                {{ study.diploma.title }}<br />
                {{ study.business.title }}
            </a>
        </li>
    </ul>
</div>

<div class="col-md-12">
    <a [routerLink]="['/Profile/Testimonials']">
        <h3>Recommendations &nbsp;
            <span class="badge">{{ testimonials.length }}</span>
            &nbsp; <span *ngIf="editableProfile" class="fa fa-pencil"></span>
        </h3>
    </a>
    <ul>
        <li *ngFor="let testimonial of testimonials">
            {{ testimonial.business.title }}
        </li>
    </ul>
</div>

<div bsModal
     #profilePictureModal="bs-modal"
     class="modal fade"
     tabindex="-1"
     role="dialog"
     id="profile-picture-modal"
     aria-hidden="true">
    <div class="modal-dialog modal-md">
        <div class="modal-content">
            <div class="modal-body">
                <div ng2FileDrop
                     [ngClass]="{'nv-file-over': hasBaseDropZoneOver}"
                     (fileOver)="fileOverBase($event)"
                     (onFileDrop)="fileDropped($event)"
                     [uploader]="uploader"
                     class="well file-drop-zone">
                    Déposez votre fichier ici
                </div>

                <input type="file"
                       ng2FileSelect
                       [uploader]="uploader"
                       (change)="fileChangeListener($event)"/>

                <img-cropper #cropper [image]="profilePictureData" [settings]="cropperSettings">

                </img-cropper>
                <span class="cropping-result" *ngIf="profilePictureData.image" >
                    <img [src]="profilePictureData.image"
                         [width]="cropperSettings.croppedWidth"
                         [height]="cropperSettings.croppedHeight">
                </span>
            </div>
            <div class="modal-footer">
                <button type="button"
                        class="btn btn-default"
                        id="close-profile-picture-modal"
                        (click)="profilePictureModal.hide()"
                        data-dismiss="modal">
                    Annuler
                </button>
                <button type="button"
                        class="btn btn-primary"
                        [disabled]="isLoading"
                        (click)="uploadProfilePicture()">
                    <span *ngIf="!isLoading">Enregistrer</span>
                    <span *ngIf="isLoading">
                        <span class="fa fa-spinner fa-spin"></span> &nbsp;Chargement...
                    </span>
                </button>
            </div>
        </div>
    </div>
</div>