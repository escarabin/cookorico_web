<ul>
    <li class="row"
        *ngFor="let club of clubs; let i = index">
        <div class="col-md-2 col-sm-2 hidden-xs">
            <img src="{{ club.profilePictureUrl }}"
                 *ngIf="club.profilePictureUrl"
                 class="full-width"/>
        </div>
        <div class="col-md-4">
            <h3>{{ club.username }}</h3>
            <span class="fa fa-user"></span> &nbsp; {{ club.firstName }} {{ club.lastName }}<br />
            <span *ngIf="club.phone">
                <span class="fa fa-phone"></span> &nbsp; {{ club.phone }}<br />
            </span>
            <span class="fa fa-envelope"></span> &nbsp; {{ club.email }}
        </div>
        <div class="col-md-3 centered">
            <br />
            <button class="btn btn-default"
                    (click)="loginUsingId(club.id)">
                Accéder
            </button>
            <br />
            <button class="btn btn-primary"
                    routerLink="/club/{{ club.id }}">
                Page emploi
            </button>
        </div>
        <div class="col-md-3 centered">
            <br />
            <button class="btn btn-warning"
                    (click)="deleteClub(club.id)">
                Supprimer ce
                <span *ngIf="!isGroupEdtingMode">club</span>
                <span *ngIf="isGroupEdtingMode">groupe</span>
            </button>
            <button class="btn btn-success"
                    (click)="editClub(club)">
                Modifier ce
                <span *ngIf="!isGroupEdtingMode">club</span>
                <span *ngIf="isGroupEdtingMode">groupe</span>
            </button>
        </div>
        <div class="col-md-12">
            <hr />
            <div class="col-md-12">
                <business-select [isRequired]="true"
                                 (businessIdChange)="handleBusinessIdChange($event, club.id)">

                </business-select>
            </div>
            <div class="col-md-10">
                <br />
                <label>ID de l'établissement</label>
                <input type="text"
                       [(ngModel)]="businessIdList[i]"
                       ngControl="businessIdList[i]"
                       class="form-control"
                       placeholder="ID de l'établissement"/>
            </div>
            <div class="col-md-2">
                <br/>
                <br/>
                <button class="btn btn-primary"
                        (click)="handleBusinessIdChange(businessIdList[i], club.id)">
                    Ajouter
                </button>
            </div>
            <div class="col-md-12" style="border-top: 1px solid #CCC">
                <ul>
                    <li *ngFor="let business of club.businesses"
                        class="row business">
                        <div class="col-md-2 col-sm-2 hidden-xs logo-container" *ngIf="business.logo">
                            <img src="{{ business.logo }}"
                                 class="full-width"/>
                        </div>
                        <div [class.col-md-8]="business.logo"
                             [class.col-md-10]="!business.logo"
                             [class.col-sm-8]="business.logo"
                             [class.col-sm-10]="!business.logo"
                             class="col-xs-10">
                            <h3>{{ business.title }}</h3>
                            <span *ngIf="business.place && business.place.adress">
                                <b>{{ business.place.adress }}</b>
                            </span><br />
                            <span *ngIf="business.place && business.place.city">
                                {{ business.place.city }}
                            </span>
                        </div>
                        <div class="col-md-2">
                            <br />
                            <button class="btn btn-default"
                                    (click)="detachBusinessFromClub(club.id, business.id)">
                                Détacher
                            </button>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </li>
</ul>

<div class="row create-club">
    <form #createClubForm="ngForm">
        <div class="col-md-12 centered">
            <h2>
                <span *ngIf="!club.id">Créer</span> <span *ngIf="club.id">Modifier</span> un <span *ngIf="!isGroupEdtingMode">club</span>
                <span *ngIf="isGroupEdtingMode">groupe</span>
            </h2>
            <br />
            <button class="btn btn-default"
                    *ngIf="club.id"
                    (click)="club = {'plans': [{}]}">
                Créer un nouveau groupe
            </button>
            <br />
            <br />
        </div>
        <div class="col-md-6">
            <input type="text"
                   required
                   [(ngModel)]="club.username"
                   ngControl="club.username"
                   name="username"
                   placeholder="Nom"
                   class="form-control"/>
        </div>
        <div class="col-md-6">
            <input type="text"
                   class="form-control"
                   required
                   name="place"
                   placeholder="Lieu"
                   (setAddress)="parseAdress($event)"
                   googleplace/>
        </div>
        <div class="col-md-6 centered">
            <div ng2FileDrop
                 [ngClass]="{'nv-file-over': hasBaseDropZoneOver}"
                 (fileOver)="fileOverBase($event)"
                 (onFileDrop)="resumeFileDropped($event)"
                 [uploader]="resumeUploader"
                 class="well file-drop-zone">
                Déposez votre fichier ici
            </div>

            <input type="file"
                   ng2FileSelect
                   [uploader]="resumeUploader"
                   (change)="fileChangeListener($event)"/>
            <span class="cropping-result" *ngIf="profilePictureData.image" >
                <h3>Ceci sera le logo</h3><br />
                <img [src]="profilePictureData.image"
                     [width]="cropperSettings.croppedWidth"
                     [height]="cropperSettings.croppedHeight">
            </span>
        </div>
        <div class="col-md-6">
            <img-cropper #cropper [image]="profilePictureData" [settings]="cropperSettings">

            </img-cropper>
        </div>
        <div class="col-md-12 centered">
            <h3>
                Contact du <span *ngIf="!isGroupEdtingMode">club</span>
                <span *ngIf="isGroupEdtingMode">groupe</span>
            </h3>
        </div>
        <div class="col-md-6">
            <label>Email</label>
            <input type="text"
                   [(ngModel)]="club.email"
                   ngControl="club.email"
                   name="email"
                   required
                   placeholder="Email du contact"
                   class="form-control"/>
        </div>
        <div class="col-md-6"
             *ngIf="club.id">
            <label>Mot de passe</label>
            <input type="password"
                   [(ngModel)]="club.password"
                   ngControl="club.password"
                   name="password"
                   required
                   placeholder="Mot de passe du compte"
                   class="form-control"/>
        </div>
        <div class="col-md-6">
            <label>Nom</label>
            <input type="text"
                   [(ngModel)]="club.lastName"
                   ngControl="club.lastName"
                   name="lastName"
                   placeholder="Nom du contact"
                   class="form-control"/>
        </div>
        <div class="col-md-6">
            <label>Prénom</label>
            <input type="text"
                   [(ngModel)]="club.firstName"
                   ngControl="club.firstName"
                   name="firstName"
                   placeholder="Prénom du contact"
                   class="form-control"/>
        </div>
        <div class="col-md-6">
            <label>Téléphone</label>
            <input type="text"
                   [(ngModel)]="club.phone"
                   ngControl="club.phone"
                   name="phone"
                   placeholder="Téléphone du contact"
                   class="form-control"/>
        </div>
        <div class="col-md-6"
             *ngIf="club.plans">
            <label>Emplacements</label>
            <input type="number"
                   [(ngModel)]="club.plans[0].spaces"
                   ngControl="club.plans[0].spaces"
                   name="groupSpacesAmount"
                   placeholder="Emplacements"
                   class="form-control"/>
        </div>
        <div class="col-md-6"
             *ngIf="club.plans">
            <label>Contacts</label>
            <input type="number"
                   [(ngModel)]="club.plans[0].daily_contacts"
                   ngControl="club.plans[0].daily_contacts"
                   name="groupSpacesAmount"
                   placeholder="Emplacements"
                   class="form-control"/>
        </div>
        <div class="col-md-12 centered">
            <br />
            <button class="btn btn-default"
                    (click)="saveClub()"
                    [disabled]="isSavingClub || !createClubForm.valid">
                Enregistrer <span class="fa fa-spinner fa-spin" *ngIf="isSavingClub"></span>
            </button>
        </div>
    </form>
</div>